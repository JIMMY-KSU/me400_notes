<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Lecture 19 - Numerical Integration &mdash; ME 400 Course Notes Fall 2018 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Fall 2018',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ME 400 Course Notes Fall 2018 documentation" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Lecture-19---Numerical-Integration">
<h1>Lecture 19 - Numerical Integration<a class="headerlink" href="#Lecture-19---Numerical-Integration" title="Permalink to this headline">¶</a></h1>
<p>Last time, finite-difference approximations were developed and used to
evaluate derivatives numerically. In this lecture, we&#8217;ll explore and
implement our own numerical methods for evaluation of integrals. We&#8217;ll
also use the SciPy module for the first time, which provides its own set
of tools for numerical integration.</p>
<div class="section" id="Objectives">
<h2>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¶</a></h2>
<p>By the end of this lesson, you should be able to</p>
<ul class="simple">
<li>Evaluate definite integrals numerically using left- and right-sided
Riemann sums, the mid-point rule, and the trapezoid rule.</li>
<li>Evaluate definite integrals numerically using the built-in functions
of <code class="docutils literal"><span class="pre">scipy.integrate</span></code></li>
<li>Establish the order of an integration scheme using graphical means</li>
</ul>
</div>
<div class="section" id="Key-Terms">
<h2>Key Terms<a class="headerlink" href="#Key-Terms" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Riemann sum</li>
<li>left-sided Riemann sum</li>
<li>right-sided Riemann sum</li>
<li>mid-point rule</li>
<li>trapezoid rule</li>
<li><code class="docutils literal"><span class="pre">scipy.integrate</span></code></li>
<li><code class="docutils literal"><span class="pre">scipy.integrate.quad</span></code></li>
<li><span class="math">\(n\)</span>th-order approximation</li>
</ul>
<div class="section" id="Riemann-Sums-in-Practice">
<h3>Riemann Sums in Practice<a class="headerlink" href="#Riemann-Sums-in-Practice" title="Permalink to this headline">¶</a></h3>
<p>For <span class="math">\(df/dx\)</span>, choose two or more values of <span class="math">\(f\)</span> (forward,
backward, etc.) and take <span class="math">\(\Delta\)</span> to some small but finite value.</p>
<p>For <span class="math">\(\int^b_a f(x) dx\)</span>, we have analogs to these choices based on
how we define the rectangles (or other shapes).</p>
<p>Recall the formal definition for a definite integral:</p>
<div class="math">
\[\int^b_a f(x) dx =
   \lim_{n \to \infty} \sum^{n}_{i=1} f \left ( \overbrace{i \frac{b-a}{n} + a}^{x_i} \right )
   \overbrace{\frac{b-a}{n}}^{\Delta}\]</div>
<p>for uniformly spaced points
<span class="math">\(x_i = a + \Delta, a + 2\Delta, \ldots, b - \Delta\)</span>.</p>
<p>If we <em>don&#8217;t take the limit</em>, we have the <strong>right-sided Riemann sum</strong>
approximation</p>
<div class="math">
\[\int^b_a f(x) dx \approx \Delta \sum^{n}_{i=1} f \left ( i \Delta + a \right )\]</div>
<p>where</p>
<div class="math">
\[\Delta = \frac{b-a}{n} \, .\]</div>
<p>and <span class="math">\(n\)</span> is the number of rectangles.</p>
<p><em>Note</em>: the formula is for <em>constant</em> step <span class="math">\(\Delta\)</span>! Put
<span class="math">\(\Delta_i\)</span> inside the sum if not constant.</p>
<p>Let&#8217;s look at this concretely for <span class="math">\(f(x) = x^2\)</span> over
<span class="math">\(x\in[0, 1]\)</span> with <span class="math">\(n=5\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">riemann_sum_plots</span>
<span class="n">riemann_sum_plots</span><span class="o">.</span><span class="n">right_sided_sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;Figure size 640x480 with 1 Axes&gt;
</pre></div>
</div>
</div>
<p>If instead we defined our sum to be</p>
<div class="math">
\[S =\frac{b-a}{n} \sum^{n}_{i=1} f \Bigg ( \frac{ (i-1)(b-a) }{n} + a \Bigg )\]</div>
<p>the picture becomes</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">riemann_sum_plots</span><span class="o">.</span><span class="n">left_sided_sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_19_Slides_9_0.png" src="../_images/lectures_ME400_Lecture_19_Slides_9_0.png" />
</div>
</div>
<p><strong>Exercise</strong>: Use the left-sided sum to estimate <span class="math">\(\int^2_0 e^x dx\)</span>
for 10, 100, and 1000 evenly-spaced points. What is the <em>absolute</em> error
for each?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">I_ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span>
<span class="n">I_10</span><span class="p">,</span> <span class="n">I_100</span><span class="p">,</span> <span class="n">I_1000</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>

</pre></div>
</div>
</div>
<p><strong>Exercise</strong>: Consider the following two columns of data:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><span class="math">\(x\)</span></th>
<th class="head"><span class="math">\(\sqrt{x}\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0.0000</td>
<td>0.0000</td>
</tr>
<tr class="row-odd"><td>0.3333</td>
<td>0.5774</td>
</tr>
<tr class="row-even"><td>1.0000</td>
<td>1.0000</td>
</tr>
<tr class="row-odd"><td>1.5000</td>
<td>1.2247</td>
</tr>
<tr class="row-even"><td>2.0000</td>
<td>1.4142</td>
</tr>
</tbody>
</table>
<p>Estimate <span class="math">\(\int^2_0 f(x) dx\)</span> using the right-sided sum and
left-sided sum. Note that the <span class="math">\(x\)</span> points are <strong>not evenly
spaced</strong>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3333</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">1.5000</span><span class="p">,</span> <span class="mf">2.0000</span><span class="p">])</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5774</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">1.2247</span><span class="p">,</span> <span class="mf">1.4142</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Beyond-the-One-Side-Sums">
<h3>Beyond the One-Side Sums<a class="headerlink" href="#Beyond-the-One-Side-Sums" title="Permalink to this headline">¶</a></h3>
<p>We can do better. As motivation, note that the central difference is
nothing but an <em>average</em> of the forward and backward differences:</p>
<div class="math">
\[\frac{1}{2} \Bigg ( \frac{f(x+h)-f(x)}{h} + \frac{f(x)-f(x-h)}{h} \Bigg ) = \frac{f(x+h)-f(x-h)}{2h}\]</div>
<p><strong>Option I</strong>: evaluate <span class="math">\(f\)</span> at the average (middle) <span class="math">\(x\)</span>
points:</p>
<div class="math">
\[S = \frac{b-a}{n} \sum^{n}_{i=1} f \Bigg ( \frac{ (i-1/2)(b-a) }{n} + a \Bigg )\]</div>
<p>for which the picture becomes</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">riemann_sum_plots</span><span class="o">.</span><span class="n">midpoint_sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_19_Slides_16_0.png" src="../_images/lectures_ME400_Lecture_19_Slides_16_0.png" />
</div>
</div>
<p>This is the <strong>midpoint rule</strong>. It is great if <em>you</em> get to choose your
points, but hard to apply to tabulated data.</p>
<p><strong>Option II</strong>: Use the same points as one-sides sums, but <em>average</em> the
<span class="math">\(f\)</span> values:</p>
<div class="math">
\[\begin{split}\begin{split}
  S &amp;= \frac{b-a}{2n}
    \Bigg [ \sum^{n}_{i=1} f \Bigg ( \frac{ (i)(b-a) }{n} + a \Bigg )
         +  \sum^{n}_{i=1} f \Bigg ( \frac{ (i-1)(b-a) }{n} + a \Bigg ) \Bigg ] \\
    &amp;= \frac{b-a}{2n}
    \Bigg [ f(a) + f(b) + \sum^{n-1}_{i=1} f \Bigg ( \frac{ i(b-a) }{n} + a \Bigg ) \Bigg ]
\end{split}\end{split}\]</div>
<p>This is the <strong>trapezoid rule</strong> for uniformly-spaced points.</p>
</div>
<div class="section" id="What-About-Accuracy?">
<h3>What About Accuracy?<a class="headerlink" href="#What-About-Accuracy?" title="Permalink to this headline">¶</a></h3>
<p>It is possible to determine the <em>order</em> of various numerical integration
rules. The basic idea is to observe the (absolute) error between an
exact, reference value for an integral and the approximation of that
integral for various step sizes <span class="math">\(\Delta\)</span>.</p>
<ul class="simple">
<li>The left- and right-sided sums are <em>first order</em></li>
<li>The midpoint and trapezoid rules are <em>second order</em></li>
</ul>
</div>
<div class="section" id="Using-scipy.integrate">
<h3>Using <code class="docutils literal"><span class="pre">scipy.integrate</span></code><a class="headerlink" href="#Using-scipy.integrate" title="Permalink to this headline">¶</a></h3>
<p>The module <code class="docutils literal"><span class="pre">scipy.integrate</span></code> provides several integration functions,
including the powerful <code class="docutils literal"><span class="pre">quad</span></code> function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>In [99]: help(quad)
Help on function quad in module scipy.integrate.quadpack:

quad(func, a, b, args=(), full_output=0, epsabs=1.49e-08, epsrel=1.49e-08, limit=50, points=None, weight=None, wvar=None, wopts=None, maxp1=50, limlst=50)
    Compute a definite integral.

    Integrate func from `a` to `b` (possibly infinite interval) using a
    technique from the Fortran library QUADPACK.
</pre></div>
</div>
<p><strong>Exercise</strong>: Use <code class="docutils literal"><span class="pre">quad</span></code> to evaluate
<span class="math">\(\int^2_0 e^x dx = e^2 - 1\)</span>.</p>
<p><strong>Exercise</strong>: Use <code class="docutils literal"><span class="pre">quad</span></code> to evaluate
<span class="math">\(\int^1_0 (ax^2 + bx + c)dx\)</span> for <span class="math">\(a=b=c=1\)</span>.</p>
<p><strong>Exercise</strong>: The entropy change of an ideal gas from <span class="math">\((T_1, p_1)\)</span>
to <span class="math">\((T_2, p_2)\)</span> is</p>
<div class="math">
\[s(T_2, p_2) - s(T_1, p1) = \int^{T_2}_{T_1} \frac{c_p(T)}{T} dT - R \ln \frac{p_2}{p_1}\]</div>
<p>where <span class="math">\(s\)</span> is entropy (kJ/kg-K), <span class="math">\(p\)</span> is pressure (kPa),
<span class="math">\(T\)</span> is temperature (K), <span class="math">\(c_p\)</span> is the specific heat at
constant pressure (kJ/kg-K), and <span class="math">\(R\)</span> is the gas constant
(kJ/kg-K). For a particular gas, <span class="math">\(R = 0.18\)</span>, and</p>
<div class="math">
\[c_p = R(2.5 + 8.7\cdot 10^{-3} T - 6.7\cdot 10^{-4}T^2  + 2.0 \cdot 10^{-5} T^3 + 1.1 \cdot 10^{-7} T^4 \, .\]</div>
<p>Determine the entropy change from <span class="math">\(T_1 = 400\)</span> K and
<span class="math">\(p_1 = 1\)</span> atm to <span class="math">\(T_2 = 900\)</span>K and <span class="math">\(p_2 = 10\)</span> atm.</p>
</div>
<div class="section" id="Recap">
<h3>Recap<a class="headerlink" href="#Recap" title="Permalink to this headline">¶</a></h3>
<p>By the end of this lesson, you should be able to</p>
<ul class="simple">
<li>Evaluate definite integrals numerically using left- and right-sided
Riemann sums, the mid-point rule, and the trapezoid rule.</li>
<li>Evaluate definite integrals numerically using the built-in functions
of <code class="docutils literal"><span class="pre">scipy.integrate</span></code></li>
<li>Establish the order of an integration scheme using graphical means</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lecture 19 - Numerical Integration</a><ul>
<li><a class="reference internal" href="#Objectives">Objectives</a></li>
<li><a class="reference internal" href="#Key-Terms">Key Terms</a><ul>
<li><a class="reference internal" href="#Riemann-Sums-in-Practice">Riemann Sums in Practice</a></li>
<li><a class="reference internal" href="#Beyond-the-One-Side-Sums">Beyond the One-Side Sums</a></li>
<li><a class="reference internal" href="#What-About-Accuracy?">What About Accuracy?</a></li>
<li><a class="reference internal" href="#Using-scipy.integrate">Using <code class="docutils literal"><span class="pre">scipy.integrate</span></code></a></li>
<li><a class="reference internal" href="#Recap">Recap</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/lectures/ME400_Lecture_19_Slides.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jeremy Roberts.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/lectures/ME400_Lecture_19_Slides.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>