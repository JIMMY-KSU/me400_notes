
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lecture 24 - Data Analysis via Least-Squares Fitting &#8212; ME 400 Course Notes Fall 2017 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Fall 2017',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Lecture 23 - Root Finding and Optimization" href="ME400_Lecture_23.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="section" id="Lecture-24---Data-Analysis-via-Least-Squares-Fitting">
<h1>Lecture 24 - Data Analysis via Least-Squares Fitting<a class="headerlink" href="#Lecture-24---Data-Analysis-via-Least-Squares-Fitting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Overview,-Objectives,-and-Key-Terms">
<h2>Overview, Objectives, and Key Terms<a class="headerlink" href="#Overview,-Objectives,-and-Key-Terms" title="Permalink to this headline">¶</a></h2>
<p>A ubiquitous task in engineering and other technical disciplines is the
analysis of data. Data comes from many sources, including measurements
in the laboratory and numerical simulations. In this lecture and in
<a class="reference internal" href="ME400_Lecture_25.html"><span class="doc">Lecture 25</span></a>, we’ll apply what we’ve learned
so far to produce <em>models</em> from data that we can use to explore trends
and make conclusions. Specifically, in this lecture, we’ll develop
models based on <strong>least-squares</strong> fitting of model parameters to
existing data. Such fitting may be the right choice when the data in
contaminated by noise or when the model need only capture the main
features of the observed phenomenon.</p>
<div class="section" id="Objectives">
<h3>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¶</a></h3>
<p>By the end of this lesson, you should be able to</p>
<ul class="simple">
<li>Explain (and demonstrate) what is meant by a least-squares fit of a
linear model <span class="math">\(ax+b\)</span> to a set of measured points
<span class="math">\((x_i, y_i),\, i = 0, 1, \ldots\)</span>.</li>
<li>Use built-in tools to perform linear, least-squares fitting of data
to models</li>
<li>Use built-in tools to perform nonlinear, least-squares fitting of
data to models</li>
</ul>
</div>
<div class="section" id="Key-Terms">
<h3>Key Terms<a class="headerlink" href="#Key-Terms" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>error</li>
<li>least-squares</li>
<li>normal equation</li>
<li><code class="docutils literal"><span class="pre">np.linalg.solve</span></code></li>
<li><code class="docutils literal"><span class="pre">np.polyfit</span></code></li>
<li><code class="docutils literal"><span class="pre">np.polyval</span></code></li>
<li><code class="docutils literal"><span class="pre">scipy.optimize.curve_fit</span></code></li>
</ul>
</div>
</div>
<div class="section" id="Noisy-Data-and-">
<h2>Noisy Data and <span class="math">\(y = at + b\)</span><a class="headerlink" href="#Noisy-Data-and-" title="Permalink to this headline">¶</a></h2>
<p>We’ll start simple and explore a task with which most students ought to
be familiar: running a line through some scattered points of the form
<span class="math">\(y = at+b\)</span> through several, scattered points
<span class="math">\((t_i, y_i),\, i = 0, 1, \ldots\)</span>. To illustrate the problem,
suppose a number of measurements <span class="math">\(y_i\)</span> were taken at evenly spaced
times <span class="math">\(t_0, t_1, \ldots\)</span>, as show below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">data_fitting_examples</span> <span class="kn">import</span> <span class="n">scattered_points</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">scattered_points</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_24_2_0.png" src="../_images/lectures_ME400_Lecture_24_2_0.png" />
</div>
</div>
<p>We’ll <em>assume</em> that the observed quantity <span class="math">\(y(t)\)</span> varies <em>linearly</em>
with <span class="math">\(t\)</span>, i.e., we define <span class="math">\(y(t) = at + b\)</span>. The goal is to
find the model parameters <span class="math">\(a\)</span> and <span class="math">\(b\)</span> yielding a model that
<em>best</em> matches the observed values <span class="math">\(y_i\)</span>.</p>
<p>Before defining what exactly <em>best</em> means, try to define <span class="math">\(a\)</span> and
<span class="math">\(b\)</span> by inspection. One easy way to estimate <span class="math">\(a\)</span> and
<span class="math">\(b\)</span> is to use the first and last measured points, i.e., defined
the intercept to be <span class="math">\(b = y[0]\)</span> and the slope to be
<span class="math">\(a = (y[-1]-y[0])/(t[-1]-t[0])\)</span>.</p>
<p>The result is not bad:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y_a</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y(t)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_24_4_0.png" src="../_images/lectures_ME400_Lecture_24_4_0.png" />
</div>
</div>
</div>
<div class="section" id="What-&quot;Best&quot;-Means">
<h2>What “Best” Means<a class="headerlink" href="#What-"Best"-Means" title="Permalink to this headline">¶</a></h2>
<p>To define a “best” line, however, requires we define what “best” means.
In general, any values of <span class="math">\(a\)</span> and <span class="math">\(b\)</span> will result in a model
that differs from the measured values. This difference is the error.
More formally, let the error be defined as</p>
<div class="math">
\[e_i = y(t_i) - y_i = a t_i + b - y_i \, \quad i = 0, 1, \ldots\]</div>
<p>Here, a model provides a best fit if it minimizes the <span class="math">\(L_2\)</span> norm
of the error, which is defined as</p>
<div class="math">
\[|| \mathbf{e} ||_2 = \sqrt{ |e_0|^2 + |e_1|^2 + \ldots} = \sqrt{\sum_{i=0} |e_i|^2} \, .\]</div>
<p>Equivalently, such a model is called the <strong>least-squares</strong> fit to the
data because the sum of the errors squared is minimized.</p>
<p>For the case of the linear model <span class="math">\(y(t) = at + b\)</span>, the error can be
written in matrix form:</p>
<div class="math">
\[\begin{split}\mathbf{e} =
\left[
  \begin{matrix}
    x_0 &amp; 1 \\
    x_1 &amp; 1 \\
    \vdots &amp; 1 \\
    x_{n-1} &amp; 1
   \end{matrix}
\right]
\left[
\begin{matrix}
  a \\
  b
\end{matrix}
\right] -
\left[
\begin{matrix}
  y_0 \\
  y_1 \\
  \vdots \\
  y_{n-1}
\end{matrix}
\right] \, ,\end{split}\]</div>
<p>or <span class="math">\(\mathbf{e} = \mathbf{M}\mathbf{c} - \mathbf{y}\)</span>. Here,
<span class="math">\(\mathbf{M}\)</span> represents the generic data matrix for the model,
while <span class="math">\(\mathbf{c}\)</span> are the model coefficients that are as yet
undetermined.</p>
<blockquote>
<div><strong>Note</strong>: Generally <span class="math">\(\mathbf{M}\)</span> is <em>not</em> square and
<span class="math">\(\mathbf{e}\)</span> is generally not zero. In other words, rarely can
we hope to find <span class="math">\(\mathbf{c}\)</span> from
<span class="math">\(\mathbf{M}^{-1}\mathbf{y}\)</span>! In the example above, we had <strong>25
data points</strong> and just <strong>two unknowns</strong> (the slope <span class="math">\(a\)</span> and
intercept <span class="math">\(b\)</span>). Too many equations means an <strong>overdetermined</strong>
system!</div></blockquote>
<p>Recall that <span class="math">\(||\mathbf{e}||_2 = \sqrt{\mathbf{e}^T \mathbf{e}}\)</span>,
where <span class="math">\(T\)</span> represents the matrix transpose. Moreover, if <span class="math">\(a\)</span>
and <span class="math">\(b\)</span> are found to minimize
<span class="math">\(\sqrt{\mathbf{e}^T \mathbf{e}}\)</span>, then they also minimize
<span class="math">\(\mathbf{e}^T \mathbf{e}\)</span>.</p>
<blockquote>
<div><strong>Note</strong>: First, convince yourself <span class="math">\(||\mathbf{e}||_2 \geq 0\)</span>,
i.e., it is nonnegative. Then, convince yourself that any <span class="math">\(x\)</span>
that minimizes a nonnegative function <span class="math">\(f(x)\)</span> also minimizes
<span class="math">\(f(x)^2\)</span>.</div></blockquote>
<p>Hence, the best values of <span class="math">\(a\)</span> and <span class="math">\(b\)</span> minimize the
following:</p>
<div class="math">
\[\begin{split}\begin{split}
  \mathbf{e}^T \mathbf{e}
      &amp;= (\mathbf{M}\mathbf{c} - \mathbf{y})^T (\mathbf{M}\mathbf{c} - \mathbf{y}) \\
      &amp;= \mathbf{c}^T \mathbf{M}^T \mathbf{Mc} - 2 \mathbf{c}^T \mathbf{M}^T \mathbf{y}  + \mathbf{y}^T\mathbf{y} \, .
\end{split}\end{split}\]</div>
<p>Now, remember (e.g., from <a class="reference internal" href="ME400_Lecture_23.html"><span class="doc">Lecture 23</span></a>) that
the minimum of a function <span class="math">\(f(x)\)</span> (nonlinear or otherwise) can be
found when its <em>derivative</em> is zero. In this case, that function is
<span class="math">\(f(\mathbf{c})\)</span>, and the “derivative” is the <em>gradient</em>
<span class="math">\(\nabla ||\mathbf{e}||\)</span>. Thus, differentiation leads to</p>
<div class="math">
\[\nabla \mathbf{e}^T \mathbf{e} = 2 \mathbf{M}^T \mathbf{M} \mathbf{c} - 2\mathbf{M}^T \mathbf{y} = \mathbf{0} \, ,\]</div>
<p>or</p>
<div class="math">
\[\mathbf{M}^T \mathbf{M} \mathbf{c} = \mathbf{M}^T \mathbf{y} \, .\]</div>
<p>This equation is often called the <a class="reference external" href="http://mathworld.wolfram.com/NormalEquation.html">normal
equation</a>. The
coefficients <span class="math">\(\mathbf{c}\)</span> leading to the best fit are defined by</p>
<div class="math">
\[\mathbf{c} = (\mathbf{M}^T \mathbf{M})^{-1}  \mathbf{M}^T \mathbf{y} \, .\]</div>
<p>Because <span class="math">\(\mathbf{M}^T \mathbf{M}\)</span> is square, the system has the
same number of equations as it does unknowns. That alone does not
guarantee a solution, but a solution is much more likely.</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: Consider the three pairs of points <span class="math">\((1, 1)\)</span>,
<span class="math">\((2, 1.5)\)</span>, <span class="math">\((3, 4.5)\)</span>. Find <span class="math">\(a\)</span> and <span class="math">\(b\)</span> such
that <span class="math">\(y(x) = ax+b\)</span> best fits the three points.</p>
<p><em>Solution</em>:</p>
<p>First, define the points:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Then, define the <span class="math">\(3 \times 2\)</span> matrix <span class="math">\(\mathbf{M}\)</span>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<p>Finally, solve the system (review <a class="reference internal" href="ME400_Lecture_4.html"><span class="doc">Lecture 4</span></a>
for <span class="math">\(\mathbf{c}\)</span> and define the approximation for
<span class="math">\(\mathbf{y}\)</span> via <span class="math">\(a\mathbf{x} + b\)</span> (equivalent to
<span class="math">\(\mathbf{M}\mathbf{c}\)</span>). For sanity, plot the result with the
original points.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;c = &quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">y_a</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_a</span><span class="p">,</span> <span class="s1">&#39;r--x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;approximate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
c =  [ 1.75       -1.16666667]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_24_11_1.png" src="../_images/lectures_ME400_Lecture_24_11_1.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Exercise</strong>: Compute <span class="math">\(\mathbf{e}\)</span> for the last example. Then,
evaluate
<span class="math">\(\mathbf{e}^T \mathbf{y}_a = \mathbf{e}\cdot \mathbf{y}_a\)</span>.</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: Using pen and paper (or SymPy), convince yourself that
<span class="math">\(\nabla ||\mathbf{e}||_2\)</span> leads to the normal equation. (I’ll
point out this has been a previous exam question. Hardly worth using a
method unless you know how it works.)</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: What would <span class="math">\(\mathbf{M}\)</span> and <span class="math">\(\mathbf{c}\)</span> look
like if we wished to fit a set of <span class="math">\((x_i, y_i)\)</span> points to a
<em>quadratic model</em>? (Hint, <span class="math">\(\mathbf{M}\)</span> should have three columns.)</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: Sometimes data can be modeled by a simple, linear model
after some simple transformations. Consider the following data, which
represents the power of our Kansas State University TRIGA Reactor at
<span class="math">\(t = 0, 1, \ldots, 10\)</span> seconds upon initiating some experiments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">2.945</span><span class="p">,</span> <span class="mf">3.964</span><span class="p">,</span> <span class="mf">4.481</span><span class="p">,</span> <span class="mf">5.747</span><span class="p">,</span> <span class="mf">7.523</span><span class="p">,</span> <span class="mf">8.710</span><span class="p">,</span> <span class="mf">10.733</span><span class="p">,</span> <span class="mf">13.910</span><span class="p">,</span> <span class="mf">16.721</span><span class="p">,</span> <span class="mf">19.951</span><span class="p">,</span> <span class="mf">24.610</span>
</pre></div>
</div>
<p>Plot this data and confirm that the power <span class="math">\(P\)</span> is <em>not linear</em> in
time. However, by inspection, it appears that the <em>logarithm</em> of the
power <em>is</em> linear (which you should also confirm). Fit <span class="math">\(\log P\)</span> to
the model <span class="math">\(a t + b\)</span>, and then plot <span class="math">\(P\)</span> and its approximation
from the model versus time.</p>
<p><em>Solution</em>:</p>
<p>First, let’s confirm the nonlinearity of <span class="math">\(P\)</span> and the linearity of
<span class="math">\(\log P\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.945</span><span class="p">,</span> <span class="mf">3.964</span><span class="p">,</span> <span class="mf">4.481</span><span class="p">,</span> <span class="mf">5.747</span><span class="p">,</span> <span class="mf">7.523</span><span class="p">,</span> <span class="mf">8.710</span><span class="p">,</span> <span class="mf">10.733</span><span class="p">,</span> <span class="mf">13.910</span><span class="p">,</span> <span class="mf">16.721</span><span class="p">,</span> <span class="mf">19.951</span><span class="p">,</span> <span class="mf">24.610</span><span class="p">])</span>
<span class="n">logP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;k-o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$P(t)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">logP</span><span class="p">,</span> <span class="s1">&#39;r--x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\log(P(t))$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_24_13_0.png" src="../_images/lectures_ME400_Lecture_24_13_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_24_13_1.png" src="../_images/lectures_ME400_Lecture_24_13_1.png" />
</div>
</div>
<p>Now, fit <span class="math">\(\log{P}\)</span> to <span class="math">\(at + b\)</span>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">**</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">logP</span><span class="p">))</span>
<span class="n">logP_a</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally, evaluate <span class="math">\(P\)</span> from its logarithm and plot the result
against the reference:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">P_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logP_a</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;k-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$P(t)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">P_a</span><span class="p">,</span> <span class="s1">&#39;r--x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$P_a(t)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_24_17_0.png" src="../_images/lectures_ME400_Lecture_24_17_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Exercise</strong>: Inspect the following <span class="math">\((x_i, y_i)\)</span> data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">x</span>            <span class="n">y</span>
<span class="mf">0.20515647</span><span class="p">,</span>  <span class="mf">0.59102462</span>
<span class="mf">0.54550627</span><span class="p">,</span>  <span class="mf">0.84583853</span>
<span class="mf">0.59262142</span><span class="p">,</span>  <span class="mf">0.80724061</span>
<span class="mf">2.17819173</span><span class="p">,</span>  <span class="mf">1.63791106</span>
<span class="mf">3.82397005</span><span class="p">,</span>  <span class="mf">2.10229436</span>
<span class="mf">4.88966586</span><span class="p">,</span>  <span class="mf">2.35676675</span>
<span class="mf">7.87776356</span><span class="p">,</span>  <span class="mf">2.91240054</span>
<span class="mf">8.10359230</span><span class="p">,</span>  <span class="mf">3.03207498</span>
</pre></div>
</div>
<p>Determine a good transformation, and fit the result to <span class="math">\(ax + b\)</span>.
Apply the inverse transormation, and compare the resulting
approximations to the original data.</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: How would you</p>
</div>
<div class="section" id="Beyond-Linear-Models">
<h2>Beyond Linear Models<a class="headerlink" href="#Beyond-Linear-Models" title="Permalink to this headline">¶</a></h2>
<p>Of course, not all data is intrinsically linear, and we may not be able
to apply transformations to make it so. An alternative is to use
higher-order polynomial models of the for
<span class="math">\(y(x) = a_n x^n + a_{n-1} x^{n-1} + \ldots + a_0\)</span>. Although this
is reasonably straightforward to accomplish by adapting the methods
presented above, NumPy has a few built-in functions to simplify the
process.</p>
<p>The first of these functions is <code class="docutils literal"><span class="pre">np.polyfit</span></code>, for which basic use
requires three input arguments: <code class="docutils literal"><span class="pre">x</span></code>, <code class="docutils literal"><span class="pre">y</span></code>, and <code class="docutils literal"><span class="pre">order</span></code>. Here, <code class="docutils literal"><span class="pre">x</span></code>
and <code class="docutils literal"><span class="pre">y</span></code> correspond to the discrete points to which the polynomial is
fitted, and <code class="docutils literal"><span class="pre">order</span></code> is the highest power of <span class="math">\(x\)</span> in the
polynomial. Returned by <code class="docutils literal"><span class="pre">np.polyfit</span></code> is the array of coefficients
<span class="math">\(a_n, a_{n-1}, \ldots\)</span> that define the polynomial.</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: Use <code class="docutils literal"><span class="pre">np.polyfit</span></code> to reproduce the values of <code class="docutils literal"><span class="pre">c</span></code> from
the three-point exercise above.</p>
<p><em>Solution</em>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;c = &#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
c =  [ 1.75       -1.16666667]
</pre></div></div>
</div>
<p>These are the same values computed by solving the normal equations
(because <code class="docutils literal"><span class="pre">np.polyfit</span></code> performs the same least-squares procedure).
***</p>
<p>To evaluate the data, one can use the returned coefficients directly,
e.g., <code class="docutils literal"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">c[0]*x</span> <span class="pre">+</span> <span class="pre">c[1]</span></code>. However, <code class="docutils literal"><span class="pre">np.polyval</span></code> provides a way to
evaluate the resulting model for any value(s) of <code class="docutils literal"><span class="pre">x</span></code>. The function
<code class="docutils literal"><span class="pre">np.polyval</span></code> takes just two arguments: the coefficients (i.e., <code class="docutils literal"><span class="pre">c</span></code>)
and the value(s) of <code class="docutils literal"><span class="pre">x</span></code>.</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: Evaluate <span class="math">\(y(x)\)</span> for the previous exercise for
<code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4]</span></code>.</p>
<p><em>Solution</em>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>array([-1.16666667,  0.58333333,  2.33333333,  4.08333333,  5.83333333])
</pre></div>
</div>
</div>
<hr class="docutils" />
<p><strong>Exercise</strong>: Fit the reactor power from above to a cubic function of
time. Plot both the original data and the fitted results. Produce a
second plot with the error as a function of time.</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: Consider <code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">np.linspace(0,</span> <span class="pre">np.pi/2,</span> <span class="pre">100)</span></code> and
<code class="docutils literal"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">np.cos(x)</span></code>. Fit <code class="docutils literal"><span class="pre">y</span></code> to polynomials of order 2, 3, 4, and 5.
Produce a second plot with the errors between y and the various models.
(By the way, do the coefficients for the second order look familiar? Go
revisit a past homework.)</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: What would <span class="math">\(\mathbf{M}\)</span> and <span class="math">\(\mathbf{c}\)</span> look
like if we wished to fit a set of <span class="math">\((x_i, y_i)\)</span> points to a a model
like <span class="math">\(a + bx + c\sin(x)\)</span>? (Hint, <span class="math">\(\mathbf{M}\)</span> should have
three columns.)</p>
</div>
<hr class="docutils" />
<div class="section" id="Beyond-Polynomial-Models">
<h2>Beyond Polynomial Models<a class="headerlink" href="#Beyond-Polynomial-Models" title="Permalink to this headline">¶</a></h2>
<p>Linear models are common, and polynomial models can provide necessary
improvements. For many cases, neither type of model is sufficient. As an
example, consider time-dependent measurements of a process known to be
oscillatory but whose parameters (e.g., frequency, phase shift, etc.)
are unknown. Such a model may take the form
<span class="math">\(y(t) = a\sin(bt + c) + d\)</span>. Such a model can be approximated
locally (or within a single period) with polynomials, but such a model
hides the physics (as quantified by <span class="math">\(a\)</span>, <span class="math">\(b\)</span>, <span class="math">\(c\)</span>,
and/or <span class="math">\(d\)</span> in the sinusoidal model).</p>
<p>Built into <code class="docutils literal"><span class="pre">scipy.optimize</span></code> is the function <code class="docutils literal"><span class="pre">curve_fit</span></code>, which can
be used to determine the coefficients of arbitrary nonlinear models by
applying <em>nonlinear</em> least squares.</p>
<p>To dig into <code class="docutils literal"><span class="pre">curve_fit</span></code>, consider the result of <code class="docutils literal"><span class="pre">help(curve_fit)</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Help on function curve_fit in module scipy.optimize.minpack:

curve_fit(f, xdata, ydata, p0=None, sigma=None, absolute_sigma=False, check_finite=True, bounds=(-inf, inf), method=None, jac=None, **kwargs)
    Use non-linear least squares to fit a function, f, to data.

    Assumes ``ydata = f(xdata, *params) + eps``
</pre></div>
</div>
<p>Here, <code class="docutils literal"><span class="pre">f</span></code> must be a function of the form <code class="docutils literal"><span class="pre">def</span> <span class="pre">func(x,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">...)</span></code>,
where <code class="docutils literal"><span class="pre">x</span></code> is the independent variable and <code class="docutils literal"><span class="pre">a</span></code>, <code class="docutils literal"><span class="pre">b</span></code>, etc., are the
model parameters. The second and third arguments <code class="docutils literal"><span class="pre">xdata</span></code> and <code class="docutils literal"><span class="pre">ydata</span></code>
are the independent and dependent variables, respectively, against which
the fit is to be made. Optionally, <code class="docutils literal"><span class="pre">p0</span></code> is an initial guess for the
model parameters. An initial guess is strongly recommended, since the
default value for each is unity, which may be far from a reasonable
guess.</p>
<p>As output, <code class="docutils literal"><span class="pre">curve_fit</span></code> returns two values: (1) the array of best-fit,
model coefficients and (2) the covariance of these model coefficients.
For most purposes, only the first return value is needed (just be
careful to extract it properly).</p>
<hr class="docutils" />
<p><strong>Exercise</strong>: Consider the following data acquired at times
<span class="math">\(0, 0.1, 0.2, \ldots, 1.0\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1.7222</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4074</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0098</span><span class="p">,</span> <span class="mf">0.9937</span><span class="p">,</span> <span class="mf">3.0986</span><span class="p">,</span> <span class="mf">3.0519</span><span class="p">,</span> <span class="mf">2.0899</span><span class="p">,</span> <span class="mf">0.2276</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2550</span><span class="p">,</span> <span class="mf">0.2815</span><span class="p">,</span> <span class="mf">2.2938</span>
</pre></div>
</div>
<p>Fit this to the model <span class="math">\(y(t) = a\sin(bt + c) + d\)</span> using
<code class="docutils literal"><span class="pre">curve_fit</span></code>. Plot the best-fit model with the original data.</p>
<p><em>Solution</em>:</p>
<p>First, define the model function:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span>
</pre></div>
</div>
</div>
<p>Now, try <code class="docutils literal"><span class="pre">curve_fit</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.7222</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4074</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0098</span><span class="p">,</span> <span class="mf">0.9937</span><span class="p">,</span> <span class="mf">3.0986</span><span class="p">,</span> <span class="mf">3.0519</span><span class="p">,</span> <span class="mf">2.0899</span><span class="p">,</span> <span class="mf">0.2276</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2550</span><span class="p">,</span> <span class="mf">0.2815</span><span class="p">,</span> <span class="mf">2.2938</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[12]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>array([ 1.88133258, -9.87911136,  6.27749904,  1.45335284])
</pre></div>
</div>
</div>
<p>Finally, use <code class="docutils literal"><span class="pre">model</span></code> to construct <code class="docutils literal"><span class="pre">y_a</span></code> using <code class="docutils literal"><span class="pre">c</span></code> and plot. In
addition to the original <span class="math">\(t\)</span> points, we’ll use a much finer set of
times to illustrate the continuous model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y(t)&#39;</span><span class="p">)</span>
<span class="n">y_a</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_a</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y_a(t)&#39;</span><span class="p">)</span>
<span class="n">t_fine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_a_fine</span>  <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">t_fine</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_fine</span><span class="p">,</span> <span class="n">y_a_fine</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/lectures_ME400_Lecture_24_33_0.png" src="../_images/lectures_ME400_Lecture_24_33_0.png" />
</div>
</div>
<hr class="docutils" />
<p><strong>Exercise</strong>: Consider the following model and points:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">y_noisy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<p>Determine <span class="math">\(a\)</span>, <span class="math">\(b\)</span>, and <span class="math">\(c\)</span> using the <code class="docutils literal"><span class="pre">x</span></code> and
<code class="docutils literal"><span class="pre">y_noisy</span></code> and plot <code class="docutils literal"><span class="pre">y</span></code>, <code class="docutils literal"><span class="pre">y_noisy</span></code>, and <code class="docutils literal"><span class="pre">y_model</span></code> against <code class="docutils literal"><span class="pre">x</span></code>.</p>
</div>
<hr class="docutils" />
<div class="section" id="Further-Reading">
<h2>Further Reading<a class="headerlink" href="#Further-Reading" title="Permalink to this headline">¶</a></h2>
<p>None for now.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lecture 24 - Data Analysis via Least-Squares Fitting</a><ul>
<li><a class="reference internal" href="#Overview,-Objectives,-and-Key-Terms">Overview, Objectives, and Key Terms</a><ul>
<li><a class="reference internal" href="#Objectives">Objectives</a></li>
<li><a class="reference internal" href="#Key-Terms">Key Terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Noisy-Data-and-">Noisy Data and <span class="math">\(y = at + b\)</span></a></li>
<li><a class="reference internal" href="#What-&quot;Best&quot;-Means">What “Best” Means</a></li>
<li><a class="reference internal" href="#Beyond-Linear-Models">Beyond Linear Models</a></li>
<li><a class="reference internal" href="#Beyond-Polynomial-Models">Beyond Polynomial Models</a></li>
<li><a class="reference internal" href="#Further-Reading">Further Reading</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="ME400_Lecture_23.html" title="previous chapter">Lecture 23 - Root Finding and Optimization</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/lectures/ME400_Lecture_24.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Jeremy Roberts.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/lectures/ME400_Lecture_24.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>